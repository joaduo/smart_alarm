
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="robots" content="noindex">
    <meta name="viewport" content="width=device-width">
    <title>Smart Alarm Web Client</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.3/css/bootstrap.min.css" integrity="sha512-oc9+XSs1H243/FRN9Rw62Fn8EtxjEYWHXRvjS43YtueEewbS6ObfXcJNyohjHqVKFPoXXUxwc+q1K7Dee6vv9g==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/open-iconic/1.1.1/font/css/open-iconic-bootstrap.min.css" integrity="sha512-UyNhw5RNpQaCai2EdC+Js0QL4RlVmiq41DkmCJsRV3ZxipG2L0HhTqIf/H9Hp8ez2EnFlkBnjRGJU2stW3Lj+w==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.0.0/crypto-js.min.js" integrity="sha512-nOQuvD9nKirvxDdvQ9OMqe2dgapbPB7vYAMrzJihw5m+aNcf0dX53m6YxM4LgA9u8e9eg9QX+/+mPu8kCNpV2A==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.6.12/vue.min.js" integrity="sha512-BKbSR+cfyxLdMAsE0naLReFSLg8/pjbgfxHh/k/kUC82Hy7r6HtR5hLhobaln2gcTvzkyyehrdREdjpsQwy2Jw==" crossorigin="anonymous"></script>

    <style>
      .security-disc {
        text-security:disc; -webkit-text-security:disc;
      }
      .rotate180 {
        -webkit-transform: rotate(180deg);
        -moz-transform: rotate(180deg);
        -o-transform: rotate(180deg);
        -ms-transform: rotate(180deg);
        transform: rotate(180deg);
      }
      .imgbox {
        display: grid;
        height: 100%;
      }
      .center-fit {
        width: 95vw;
        max-width: 1024px;
        height: auto;
        margin: auto;
      }
    </style>

  </head>
  <body>
    <div id="Cameras" class="container-fluid mt-4">
      <div class="form-group">
        <button class="btn btn-primary" @click="ref_on = !ref_on"
                >{{ref_on? 'Ref': 'Shot'}}</button>
        <span v-for="name, num in cam_map">
          <button class="btn btn-outline-primary" @click="selected = num"
                  >{{name}}</button>
        </span>
        <button class="btn btn-secondary" @click="cache_time = new Date().getTime()"
                >Refresh</button>
      </div>
      <div v-for="name, num in cam_map">
        <div class="mt-3 imgbox" v-if="if_show_camera(num)">
          <img :src="camera_src(num,name)" :class="cam_class[num]"
               class="center-fit"
               @click="ref_on = !ref_on"/>
        </div>
      </div>
    </div>
  <script>
    var cam_map = {
      1:'1_jardin',
      2:'2_garaje',
      3:'3_living',
      4:'4_comedor',
      and:'android',
    }

    var cameras = new Vue({
      el: '#Cameras',
      data: {
        ref_on: false,
        first_run: '',
        cache_time: new Date().getTime(),
        cam_map: cam_map,
        selected: null,
        cam_class: {and:'rotate180',
                  },
        s3_key: null,
      },
      methods:{
        camera_src(num, name){
          if(!this.s3_key)
            return ''
          if(this.ref_on)
            return 'https://a.jduo.de/i/'+this.s3_key+'/'+name+'_ref.jpg?' + this.cache_time
          return 'https://a.jduo.de/i/'+this.s3_key+'/'+name+'.jpg?' + this.cache_time
        },
        if_show_camera(num){
          return this.selected == num || !this.selected
        },
        button_class(num){
          if(this.selected == num)
            return 'btn-primary'
          return 'btn-outline-primary'
        },
      },
      created(){
        this.s3_key = location.hash.substring(1)
        history.pushState("", document.title, window.location.pathname + window.location.search)
      },
    })
  </script>

</body>
</html>
